---
// component import
import MainHead from "./MainHead.astro";
import Navbar from "../components/Navbar.astro";
import Footer from "../components/Footer.astro";

// style import
import "../styles/global.css";

const {
  title = "HermitAI",
  description = "Your Personal AI Twin with Web Agent & RAG",
} = Astro.props;
---

<html lang="en">
  <MainHead {title} {description} />
  <body>
    <Navbar />
    <main>
      <slot />
    </main>
    <Footer />
    
    <!-- Script for theme toggle functionality -->
    <script>
      // Check for saved theme preference or use the system preference
      const getThemePreference = () => {
        if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
          return localStorage.getItem('theme');
        }
        return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
      };

      const setTheme = (theme: string) => {
        document.documentElement.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
      };

      // Set theme on load
      setTheme(getThemePreference() || 'light');

      // Listen for theme toggle events from navbar
      document.addEventListener('themeToggle', (e: Event) => {
        const event = e as CustomEvent<{ theme: string }>;
        if (event.detail && typeof event.detail.theme === 'string') {
          const newTheme = event.detail.theme;
          setTheme(newTheme);
        }
      });
    </script>
  </body>
</html>

<style>
  /* This ensures the body takes up the full viewport height */
  body {
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    width: 100%;
  }

  /* This ensures the navbar and footer span the full width */
  body > :global(nav),
  body > :global(footer) {
    width: 100%;
  }

  /* This makes the main content area flexible to fill available space */
  main {
    flex: 1;
    width: 100%;
    display: flex;
    flex-direction: column;
  }
</style>